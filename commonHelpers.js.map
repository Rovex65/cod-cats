{"version":3,"file":"commonHelpers.js","sources":["../src/js/pop-up.js","../src/js/book-api.js","../src/js/home.js","../src/js/save-book-local.js","../src/js/categories.js"],"sourcesContent":["import * as basicLightbox from 'basiclightbox';\n\nexport function onModalShow({\n  book_image,\n  title,\n  list_name,\n  description,\n  author,\n  buy_links,\n}) {\n  const modal = basicLightbox.create(\n    `<div class=\"modal\">\n      <button type=\"button\" class=\"modal-btn\">\n        <svg class=\"modal-btn-icon\" width=\"18\" height=\"18\">\n          <use href=\"../img/icons.svg#icon-close\"></use>\n        </svg>\n      </button>\n      <div class=\"modal-wrap\">\n        <img src=\"\" class=\"modal-image\" />\n        <div class=\"modal-book-wrap\">\n          <h2 class=\"modal-book-title\">HELLO BEAUTIFUL</h2>\n          <p class=\"modal-book-author\">Ann Napolitano</p>\n          <p class=\"modal-book-descr\">\n            In a homage to Louisa May Alcott’s “Little Women,” a young man’s dark\n            past resurfaces as he gets to the know the family of his college\n            sweetheart.\n          </p>\n          <div class=\"modal-logos-wrap\">\n            <img src=\"../img/amazon.png\" alt=\"\" class=\"modal-shop-list-amazon\" />\n            <img src=\"../img/book-1x.png\" alt=\"\" class=\"modal-shop-list-apple\" />\n          </div>\n        </div>\n      </div>\n      <div class=\"modal-btn-add\">\n        <button type=\"submit\" class=\"modal-add-btn\">Add to shopping list</button>\n        <p class=\"modal-btn-text\">\n          Сongratulations! You have added the book to the shopping list. To\n          delete, press the button “Remove from the shopping list”.\n        </p>\n      </div>\n    </div>\n  `,\n    {\n      onShow: modal => {\n        document.addEventListener('keydown', onModalClose);\n      },\n      onclose: modal => {\n        document.removeEventListener('keydown', onModalClose);\n      },\n    }\n  );\n  modal.show();\n\n  function onModalClose(e) {\n    if (e.key === 'Escape') {\n      modal.close();\n    }\n  }\n}\n","import axios from 'axios';\n\nexport class BookApi {\n  constructor() {\n    this.BASE_URL = 'https://books-backend.p.goit.global/books/';\n    axios.defaults.baseURL = this.BASE_URL;\n  }\n\n  async getCategoryList() {\n    const res = await axios.get('category-list');\n    return res.data;\n  }\n\n  async getTopBooks() {\n    const res = await axios.get('top-books');\n    return res.data;\n  }\n\n  async getBooksByCategory(category) {\n    const params = new URLSearchParams({ category });\n    const res = await axios.get('category', { params });\n    return res.data;\n  }\n\n  async getBookById(id) {\n    const res = await axios.get(`${id}`);\n    return res.data;\n  }\n}\n","import { templateTopBooks } from './template-functions';\nimport { templateFullCategory } from './template-functions';\nimport { templatePopUpBook } from './template-functions';\n// import { getShoppingList } from './local-storage';\n// import { updateShoppingList } from './local-storage';\nimport { onModalShow } from './pop-up';\nimport { BookApi } from './book-api';\n\nconst booksApi = new BookApi();\nconst booksWrap = document.querySelector('.books-wrapper');\nconst mainWrap = document.querySelector('.main-page');\nconst popUpBookInfo = document.querySelector('.pop-up .modal-wrap');\nconst popUpAddBtn = document.querySelector('.pop-up .modal-add-btn');\n\nfunction renderBooks(booksData) {\n  const markup = templateTopBooks(booksData);\n  booksWrap.insertAdjacentHTML('beforeend', markup);\n}\n\n// get top books\nasync function getTopBooksFromApi() {\n  try {\n    const data = await booksApi.getTopBooks();\n    renderBooks(data);\n  } catch (err) {\n    console.log(err);\n  }\n}\n\ngetTopBooksFromApi();\n\n// get books by category\nlet categoryTitle;\n\nfunction setActiveCategory(categoryTitle) {\n  const categoriesList = document.querySelectorAll(\n    '.sidebar-categories-name a'\n  );\n  const category =\n    categoryTitle === 'all-categories' ? 'all-categories' : categoryTitle;\n\n  for (let i = 0; i < categoriesList.length; i++) {\n    categoriesList[i].classList.remove('active');\n  }\n  document\n    .querySelector(`[data-category=\"${category}\"]`)\n    .classList.add('active');\n}\n\nfunction renderCategoryBooks(booksData) {\n  const markup = templateFullCategory(booksData, categoryTitle);\n  booksWrap.innerHTML = markup;\n}\n\nasync function getCategoryBooks(target) {\n  try {\n    categoryTitle = target.dataset.category;\n    setActiveCategory(categoryTitle);\n\n    if (categoryTitle === 'all-categories') {\n      booksWrap.innerHTML = '';\n\n      const data = await booksApi.getTopBooks();\n      renderBooks(data);\n    } else {\n      const data = await booksApi.getBooksByCategory(categoryTitle);\n      renderCategoryBooks(data);\n    }\n  } catch (err) {\n    console.log(err);\n  }\n}\n\n// get book by id\nfunction checkBookStatus(currentId) {\n  const shoppingList = getShoppingList();\n\n  return shoppingList.find(({ bookId }) => bookId === currentId) || false;\n}\n\nfunction getShoppingBtnData(currentId) {\n  const status = checkBookStatus(currentId);\n\n  if (status) {\n    return {\n      btnText: 'Remove from the shopping list',\n      btnClass: ['modal-add-btn', 'added'],\n    };\n  }\n\n  return {\n    btnText: 'Add to shopping list',\n    btnClass: ['modal-add-btn'],\n  };\n}\n\nfunction updateAddBtn({ _id }, { btnText, btnClass }) {\n  popUpAddBtn.textContent = btnText;\n  popUpAddBtn.setAttribute('data-id', _id);\n  popUpAddBtn.classList.add(...btnClass);\n}\n\nfunction renderPopUp(bookData, currentId) {\n  const btnData = getShoppingBtnData(currentId);\n  const markup = templatePopUpBook(bookData);\n\n  popUpBookInfo.innerHTML = markup;\n  updateAddBtn(bookData, btnData);\n}\n\nlet bookData;\nexport async function getBookById(target) {\n  try {\n    const bookId = target.closest('.book-item').dataset.bookId;\n    bookData = await booksApi.getBookById(bookId);\n    // renderPopUp(bookData, bookId);\n    onModalShow(bookData);\n  } catch (err) {\n    console.log(err);\n  }\n}\n\n// add event listeners\nmainWrap.addEventListener('click', e => {\n  const target = e.target;\n\n  // show books from the selected category\n  if (target.hasAttribute('data-category')) {\n    e.preventDefault();\n    getCategoryBooks(target);\n  }\n});\n\n// book add to/remove from the shopping list\npopUpAddBtn.addEventListener('click', e => {\n  updateShoppingList(e, bookData);\n});\n\nbooksWrap.addEventListener('click', e => {\n  const target = e.target;\n\n  // show book info in popup\n  if (target.closest('.book-item')) {\n    getBookById(target);\n  }\n});\n","import { BookApi } from './book-api';\n\nconst bookApi = new BookApi();\n\nasync function setTestBooksToLocal(category) {\n  const books = await bookApi.getBooksByCategory(category);\n  localStorage.setItem('saved-books', JSON.stringify(books));\n}\n\nsetTestBooksToLocal('Audio Fiction');\n","import { BookApi } from './book-api';\n\nconst bookApi = new BookApi();\nconst categoriesList = document.querySelector('.sidebar-categories-name');\nconst scrollingLine = document.querySelector('.scrolling-line');\n\nasync function renderCategories() {\n  try {\n    const categoryList = await bookApi.getCategoryList();\n\n    categoriesList.insertAdjacentHTML(\n      'beforeend',\n      categoryList.map(category => templateNameCategory(category)).join('')\n    );\n\n    //     const categoryItems = document.querySelectorAll('.sb-category-item');\n    //     categoryItems.forEach(item => {\n    //   item.addEventListener('click', async () => {\n    //       const categoryName = item.querySelector('a').textContent;\n    //       const books = await bookApi.getBooksByCategory(categoryName);\n    //       console.log(`Books in category ${categoryName}:`, books);\n    //   });\n    // });\n  } catch (error) {\n    console.error('Error fetching category list:', error.message);\n  }\n}\n\nfunction templateNameCategory({ list_name: category }) {\n  return `<li class=\"sb-category-item\">\n            <a href=\"#\" data-category=\"${category}\">${category}</a>\n          </li>`;\n}\n\nrenderCategories();\n"],"names":["onModalShow","book_image","title","list_name","description","author","buy_links","modal","basicLightbox.create","onModalClose","e","BookApi","axios","category","params","id","booksApi","booksWrap","mainWrap","popUpAddBtn","renderBooks","booksData","markup","templateTopBooks","getTopBooksFromApi","data","err","categoryTitle","setActiveCategory","categoriesList","i","renderCategoryBooks","templateFullCategory","getCategoryBooks","target","bookData","getBookById","bookId","bookApi","setTestBooksToLocal","books","renderCategories","categoryList","templateNameCategory","error"],"mappings":"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"}