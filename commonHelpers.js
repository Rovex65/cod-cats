import{t as w,a as C,b as v,c as T}from"./assets/switch-theme-cd7b3927.js";import{b as A,a as n,i as q}from"./assets/vendor-20403eb5.js";function E(o,t){const e=o.target,s=u();if(e.classList.toggle("added"),e.classList.contains("added")){I(e,s,t);return}R(e,s)}function u(){return JSON.parse(localStorage.getItem("shoppingList"))||[]}function I(o,t,e){const s=x(e);t.push(s),m(t),o.textContent="Remove from the shopping list"}function x(o){const{_id:t,list_name:e,author:s,book_image:i,buy_links:a,description:B,title:S}=o;return{bookId:t,image:i,title:S,category:e,description:B,author:s,buyLinks:a}}function m(o){localStorage.setItem("shoppingList",JSON.stringify(o))}function R(o,t){const e=t.filter(({bookId:s})=>s!==o.dataset.id);m(e),o.textContent="Add to shopping list"}const p=document.querySelector("body");function _(o,t,e){const s=A.create(w(o,t,e),{onShow:a=>{p.classList.add("modal-is-open"),document.addEventListener("keydown",i),a.element().querySelector(".modal-btn").onclick=a.close},onClose:a=>{p.classList.remove("modal-is-open"),document.removeEventListener("keydown",i)}});s.show();function i(a){a.key==="Escape"&&s.close()}}class y{constructor(){this.BASE_URL="https://books-backend.p.goit.global/books/",n.defaults.baseURL=this.BASE_URL}async getCategoryList(){return(await n.get("category-list")).data}async getTopBooks(){return(await n.get("top-books")).data}async getBooksByCategory(t){const e=new URLSearchParams({category:t});return(await n.get("category",{params:e})).data}async getBookById(t){return(await n.get(`${t}`)).data}}const k=document.querySelector(".home-loader");function b(){k.classList.remove("hidden")}function f(){k.classList.add("hidden")}function d(o){q.error({pauseOnHover:!1,position:"topRight",message:o})}const c=new y,g=document.querySelector(".books-wrapper");function L(o){const t=C(o);g.innerHTML=t}async function M(){h(),b();try{const o=await c.getTopBooks();L(o)}catch(o){d(o.message)}f()}M();let r;function H(o){const t=document.querySelectorAll(".sidebar-categories-name a"),e=o==="all-categories"?"all-categories":o;for(let s=0;s<t.length;s++)t[s].classList.remove("active");document.querySelector(`[data-category="${e}"]`).classList.add("active")}function O(o){const t=v(o,r);g.innerHTML=t}async function U(o){h(),b();try{if(r=o.dataset.category,H(r),r==="all-categories"){const t=await c.getTopBooks();L(t)}else{const t=await c.getBooksByCategory(r);O(t)}}catch(t){d(t.message)}f()}function D(o){return u().find(({bookId:e})=>e===o)||!1}function j(o){return D(o)?{btnText:"Remove from the shopping list",btnClass:"modal-add-btn added"}:{btnText:"Add to shopping list",btnClass:"modal-add-btn"}}let l;async function F(o){try{const t=o.closest(".book-item").dataset.bookId;l=await c.getBookById(t);const e=j(t);_(l,t,e)}catch(t){d(t.message)}}document.addEventListener("click",o=>{const t=o.target;t.hasAttribute("data-category")&&(o.preventDefault(),U(t)),t.closest(".book-item")&&F(t),t.classList.contains("modal-add-btn")&&E(o,l)});function h(){g.innerHTML=""}const J=new y,N=document.querySelector(".sidebar-categories-name");document.querySelector(".scrolling-line");async function P(){try{const o=await J.getCategoryList();N.insertAdjacentHTML("beforeend",T(o))}catch(o){d(o.message)}}P();
//# sourceMappingURL=commonHelpers.js.map
