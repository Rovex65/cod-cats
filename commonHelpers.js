import{t as f,a as h,b as L}from"./assets/switch-theme-ac9f4ee3.js";import{b as B,a as n}from"./assets/vendor-65593ac5.js";function S(o,t){const e=o.target,s=p();if(e.classList.toggle("added"),e.classList.contains("added")){w(e,s,t);return}v(e,s)}function p(){return JSON.parse(localStorage.getItem("shoppingList"))||[]}function w(o,t,e){const s=C(e);t.push(s),u(t),o.textContent="Remove from the shopping list"}function C(o){const{_id:t,list_name:e,author:s,book_image:c,buy_links:a,description:b,title:k}=o;return{bookId:t,image:c,title:k,category:e,description:b,author:s,buyLinks:a}}function u(o){localStorage.setItem("shoppingList",JSON.stringify(o))}function v(o,t){const e=t.filter(({bookId:s})=>s!==o.dataset.id);u(e),o.textContent="Add to shopping list"}const g=document.querySelector("body");function A(o,t,e){const s=B.create(f(o,t,e),{onShow:a=>{g.classList.add("modal-is-open"),document.addEventListener("keydown",c),a.element().querySelector(".modal-btn").onclick=a.close},onClose:a=>{g.classList.remove("modal-is-open"),document.removeEventListener("keydown",c)}});s.show();function c(a){a.key==="Escape"&&s.close()}}class m{constructor(){this.BASE_URL="https://books-backend.p.goit.global/books/",n.defaults.baseURL=this.BASE_URL}async getCategoryList(){return(await n.get("category-list")).data}async getTopBooks(){return(await n.get("top-books")).data}async getBooksByCategory(t){const e=new URLSearchParams({category:t});return(await n.get("category",{params:e})).data}async getBookById(t){return(await n.get(`${t}`)).data}}const i=new m,d=document.querySelector(".books-wrapper");function y(o){const t=h(o);d.insertAdjacentHTML("beforeend",t)}async function T(){try{const o=await i.getTopBooks();y(o)}catch(o){console.log(o)}}T();let r;function E(o){const t=document.querySelectorAll(".sidebar-categories-name a"),e=o==="all-categories"?"all-categories":o;for(let s=0;s<t.length;s++)t[s].classList.remove("active");document.querySelector(`[data-category="${e}"]`).classList.add("active")}function I(o){const t=L(o,r);d.innerHTML=t}async function _(o){try{if(r=o.dataset.category,E(r),r==="all-categories"){d.innerHTML="";const t=await i.getTopBooks();y(t)}else{const t=await i.getBooksByCategory(r);I(t)}}catch(t){console.log(t)}}function q(o){return p().find(({bookId:e})=>e===o)||!1}function x(o){return q(o)?{btnText:"Remove from the shopping list",btnClass:"modal-add-btn added"}:{btnText:"Add to shopping list",btnClass:"modal-add-btn"}}let l;async function M(o){try{const t=o.closest(".book-item").dataset.bookId;l=await i.getBookById(t);const e=x(t);A(l,t,e)}catch(t){console.log(t)}}document.addEventListener("click",o=>{const t=o.target;t.hasAttribute("data-category")&&(o.preventDefault(),_(t)),t.closest(".book-item")&&M(t),t.classList.contains("modal-add-btn")&&S(o,l)});const R=new m,j=document.querySelector(".sidebar-categories-name");document.querySelector(".scrolling-line");async function U(){try{const o=await R.getCategoryList();j.insertAdjacentHTML("beforeend",o.map(t=>D(t)).join(""))}catch(o){console.error("Error fetching category list:",o.message)}}function D({list_name:o}){return`<li class="sb-category-item">
            <a href="#" data-category="${o}">${o}</a>
          </li>`}U();
//# sourceMappingURL=commonHelpers.js.map
