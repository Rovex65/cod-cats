import{t as b,a as f,b as h}from"./assets/switch-theme-db8a781a.js";import{b as L,a as n}from"./assets/vendor-65593ac5.js";function B(o,t){const e=o.target,s=g();if(e.classList.toggle("added"),e.classList.contains("added")){S(e,s,t);return}C(e,s)}function g(){return JSON.parse(localStorage.getItem("shoppingList"))||[]}function S(o,t,e){const s=w(e);t.push(s),p(t),o.textContent="Remove from the shopping list"}function w(o){const{_id:t,list_name:e,author:s,book_image:c,buy_links:a,description:y,title:k}=o;return{bookId:t,image:c,title:k,category:e,description:y,author:s,buyLinks:a}}function p(o){localStorage.setItem("shoppingList",JSON.stringify(o))}function C(o,t){const e=t.filter(({bookId:s})=>s!==o.dataset.id);p(e),o.textContent="Add to shopping list"}function A(o,t,e){const s=L.create(b(o,t,e),{onShow:a=>{document.addEventListener("keydown",c),a.element().querySelector(".modal-btn").onclick=a.close},onclose:a=>{document.removeEventListener("keydown",c)}});s.show();function c(a){a.key==="Escape"&&s.close()}}class u{constructor(){this.BASE_URL="https://books-backend.p.goit.global/books/",n.defaults.baseURL=this.BASE_URL}async getCategoryList(){return(await n.get("category-list")).data}async getTopBooks(){return(await n.get("top-books")).data}async getBooksByCategory(t){const e=new URLSearchParams({category:t});return(await n.get("category",{params:e})).data}async getBookById(t){return(await n.get(`${t}`)).data}}const i=new u,d=document.querySelector(".books-wrapper");function m(o){const t=f(o);d.insertAdjacentHTML("beforeend",t)}async function v(){try{const o=await i.getTopBooks();m(o)}catch(o){console.log(o)}}v();let r;function T(o){const t=document.querySelectorAll(".sidebar-categories-name a"),e=o==="all-categories"?"all-categories":o;for(let s=0;s<t.length;s++)t[s].classList.remove("active");document.querySelector(`[data-category="${e}"]`).classList.add("active")}function E(o){const t=h(o,r);d.innerHTML=t}async function I(o){try{if(r=o.dataset.category,T(r),r==="all-categories"){d.innerHTML="";const t=await i.getTopBooks();m(t)}else{const t=await i.getBooksByCategory(r);E(t)}}catch(t){console.log(t)}}function _(o){return g().find(({bookId:e})=>e===o)||!1}function x(o){return _(o)?{btnText:"Remove from the shopping list",btnClass:"modal-add-btn added"}:{btnText:"Add to shopping list",btnClass:"modal-add-btn"}}let l;async function q(o){try{const t=o.closest(".book-item").dataset.bookId;l=await i.getBookById(t);const e=x(t);A(l,t,e)}catch(t){console.log(t)}}document.addEventListener("click",o=>{const t=o.target;t.hasAttribute("data-category")&&(o.preventDefault(),I(t)),t.closest(".book-item")&&q(t),t.classList.contains("modal-add-btn")&&B(o,l)});const M=new u,R=document.querySelector(".sidebar-categories-name");document.querySelector(".scrolling-line");async function j(){try{const o=await M.getCategoryList();R.insertAdjacentHTML("beforeend",o.map(t=>U(t)).join(""))}catch(o){console.error("Error fetching category list:",o.message)}}function U({list_name:o}){return`<li class="sb-category-item">
            <a href="#" data-category="${o}">${o}</a>
          </li>`}j();
//# sourceMappingURL=commonHelpers.js.map
