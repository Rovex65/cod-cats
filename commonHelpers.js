import{t as v,a as C,b as T,c as A}from"./assets/switch-theme-1c775d2c.js";import{b as E,a as n,i as q}from"./assets/vendor-20403eb5.js";function I(o,t){const e=o.target,s=m();if(e.classList.toggle("added"),e.classList.contains("added")){x(e,s,t);return}_(e,s)}function m(){return JSON.parse(localStorage.getItem("shoppingList"))||[]}function x(o,t,e){const s=R(e);t.push(s),y(t),o.textContent="Remove from the shopping list"}function R(o){const{_id:t,list_name:e,author:s,book_image:i,buy_links:a,description:B,title:S}=o;return{bookId:t,image:i,title:S,category:e,description:B,author:s,buyLinks:a}}function y(o){localStorage.setItem("shoppingList",JSON.stringify(o))}function _(o,t){const e=t.filter(({bookId:s})=>s!==o.dataset.id);y(e),o.textContent="Add to shopping list"}const u=document.querySelector("body");function M(o,t,e){const s=E.create(v(o,t,e),{onShow:a=>{u.classList.add("modal-is-open"),document.addEventListener("keydown",i),a.element().querySelector(".modal-btn").onclick=a.close},onClose:a=>{u.classList.remove("modal-is-open"),document.removeEventListener("keydown",i)}});s.show();function i(a){a.key==="Escape"&&s.close()}}class k{constructor(){this.BASE_URL="https://books-backend.p.goit.global/books/",n.defaults.baseURL=this.BASE_URL}async getCategoryList(){return(await n.get("category-list")).data}async getTopBooks(){return(await n.get("top-books")).data}async getBooksByCategory(t){const e=new URLSearchParams({category:t});return(await n.get("category",{params:e})).data}async getBookById(t){return(await n.get(`${t}`)).data}}const b=document.querySelector(".home-loader");function f(){b.classList.remove("hidden")}function L(){b.classList.add("hidden")}function d(o){q.error({pauseOnHover:!1,position:"topRight",message:o})}const c=new k,p=document.querySelector(".books-wrapper");function h(o){const t=C(o);p.innerHTML=t}async function U(){w(),f();try{const o=await c.getTopBooks();h(o)}catch(o){d(o.message)}L()}U();let r;function H(o){const t=document.querySelectorAll(".sidebar-categories-name a"),e=o==="all-categories"?"all-categories":o;for(let s=0;s<t.length;s++)t[s].classList.remove("active");document.querySelector(`[data-category="${e}"]`).classList.add("active")}function O(o){const t=T(o,r);p.innerHTML=t}async function D(o){w(),f();try{if(r=o.dataset.category,H(r),r==="all-categories"){const t=await c.getTopBooks();h(t)}else{const t=await c.getBooksByCategory(r);O(t)}}catch(t){d(t.message)}L()}function j(o){return m().find(({bookId:e})=>e===o)||!1}function F(o){return j(o)?{btnText:"Remove from the shopping list",btnClass:"modal-add-btn added"}:{btnText:"Add to shopping list",btnClass:"modal-add-btn"}}let l;async function J(o){try{const t=o.closest(".book-item").dataset.bookId;l=await c.getBookById(t);const e=F(t);M(l,t,e)}catch(t){d(t.message)}}document.addEventListener("click",o=>{const t=o.target;t.hasAttribute("data-category")&&(o.preventDefault(),D(t)),t.closest(".book-item")&&J(t),t.classList.contains("modal-add-btn")&&I(o,l)});function w(){p.innerHTML=""}const N=new k,P=document.querySelector(".sidebar-categories-name");document.querySelector(".scrolling-line");async function W(){try{const o=await N.getCategoryList();P.insertAdjacentHTML("beforeend",A(o))}catch(o){d(o.message)}}W();const g=document.querySelector(".scroll-up");window.addEventListener("scroll",()=>{window.scrollY>100?g.style.display="block":g.style.display="none"});g.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})});
//# sourceMappingURL=commonHelpers.js.map
