{"version":3,"file":"commonHelpers2.js","sources":["../src/img/bcg-img-shop-list.png","../src/js/shop-list.js"],"sourcesContent":["export default \"__VITE_ASSET__97b0871a__\"","import { templateShopListBooks } from './template-functions';\nimport image from '../img/bcg-img-shop-list.png';\nimport 'tui-pagination/dist/tui-pagination.css';\nimport Pagination from 'tui-pagination';\nimport './header';\nimport './support-ukraine';\nimport './switch-theme';\n\nconst listElem = document.querySelector('.shopping-list');\nconst paginationContainer = document.querySelector('.pagination-container');\nconst itemsPerPage = 3;\nlet currentPage = 1;\n\ndocument.addEventListener('DOMContentLoaded', function () {\n  initShoppingList();\n  initPagination();\n  updateShoppingList(currentPage);\n});\n\nlistElem.addEventListener('click', handleDeleteButtonClick);\n\nfunction handleDeleteButtonClick(event) {\n  if (\n    event.target.classList.contains('delete-icon') ||\n    event.target.classList.contains('svg-icon') ||\n    event.target.closest('.delete-icon') ||\n    event.target.closest('.svg-icon')\n  ) {\n    const card = event.target.closest('.shop-list-book-card');\n    if (card) {\n      const cart = JSON.parse(localStorage.getItem('shoppingList')) || [];\n      const index = cart.findIndex(\n        item =>\n          item.title === card.querySelector('.shop-list-book-title').textContent\n      );\n\n      if (index !== -1) {\n        cart.splice(index, 1);\n        localStorage.setItem('shoppingList', JSON.stringify(cart));\n\n        const startIdx = (currentPage - 1) * itemsPerPage;\n        const endIdx = startIdx + itemsPerPage;\n\n        if (index >= startIdx && index < endIdx) {\n          updateShoppingList(currentPage);\n        } else {\n          updateShoppingList(currentPage);\n        }\n        updatePagination();\n      }\n\n      const listElem = document.querySelector('.shopping-list');\n      if (listElem.querySelectorAll('.shop-list-book-card').length === 0) {\n        renderEmptyPage();\n        hidePagination();\n      }\n    }\n  }\n}\n\nfunction hidePagination() {\n  const paginationContainer = document.querySelector('.pagination-container');\n  if (paginationContainer) {\n    paginationContainer.style.display = 'none';\n  }\n}\n\nfunction updateMargin() {\n  const items = listElem.querySelectorAll('.shop-list-book-card');\n  const titleElem = document.querySelector('.title-shopping');\n\n  if (items.length === 0) {\n    titleElem.classList.add('empty-cart');\n    titleElem.classList.remove('not-empty-cart');\n  } else {\n    titleElem.classList.remove('empty-cart');\n    titleElem.classList.add('not-empty-cart');\n  }\n}\n\nfunction renderCartItems() {\n  const cartItems = JSON.parse(localStorage.getItem('shoppingList')) || [];\n  const totalItems = cartItems.length;\n\n  const renderedHTML = templateShopListBooks(cartItems);\n  listElem.innerHTML = renderedHTML;\n  updateMargin();\n\n  if (totalItems > itemsPerPage) {\n    updatePagination();\n  } else {\n    hidePagination();\n  }\n}\n\nfunction renderEmptyPage() {\n  const emptyMarkup = `\n    <p class=\"text-shopping\">\n      This page is empty, add some books and proceed to order.\n    </p>\n    <img src=${image} alt=\"\" class=\"img-shopping\" />\n  `;\n  listElem.innerHTML = emptyMarkup;\n  hidePagination();\n}\n\nfunction initShoppingList() {\n  const storedValue = localStorage.getItem('shoppingList');\n  if (storedValue === null || storedValue === undefined) {\n    renderEmptyPage();\n  } else {\n    renderCartItems();\n    updatePagination();\n  }\n}\n\nfunction initPagination() {\n  const cartItems = JSON.parse(localStorage.getItem('shoppingList')) || [];\n  const totalItems = cartItems.length;\n\n  const paginationOptions = {\n    totalItems: totalItems,\n    itemsPerPage: itemsPerPage,\n    visiblePages: 3,\n    centerAlign: false,\n    page: currentPage,\n    template: {\n      page: '<a href=\"#\" class=\"tui-page-btn\">{{page}}</a>',\n      currentPage:\n        '<strong class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\n      moveButton:\n        '<a href=\"#\" class=\"tui-page-btn tui-page-btn-moveButton\">' +\n        '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n        '</a>',\n      disabledMoveButton:\n        '<span class=\"tui-page-btn tui-page-btn-disabledMoveButton tui-is-disabled\">' +\n        '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n        '</span>',\n      moreButton:\n        '<a href=\"#\" class=\"tui-page-btn tui-page-btn-moreButton tui-{{type}}-is-ellip\">' +\n        '<span class=\"tui-ico-ellip\">...</span>' +\n        '</a>',\n    },\n  };\n\n  const pagination = new Pagination(paginationContainer, paginationOptions);\n\n  pagination.on('afterMove', function (event) {\n    currentPage = event.page;\n    updateShoppingList(currentPage);\n  });\n}\n\nfunction updateShoppingList(page) {\n  const cartItems = JSON.parse(localStorage.getItem('shoppingList')) || [];\n  const startIdx = (page - 1) * itemsPerPage;\n  const endIdx = startIdx + itemsPerPage;\n  const pageItems = cartItems.slice(startIdx, endIdx);\n\n  listElem.innerHTML = '';\n\n  const renderedHTML = templateShopListBooks(pageItems);\n  listElem.innerHTML = renderedHTML;\n\n  restorePaginationButtonsClasses();\n\n  updateMargin();\n\n  if (cartItems.length === 0) {\n    renderEmptyPage();\n  }\n}\n\nfunction updatePagination() {\n  const cartItems = JSON.parse(localStorage.getItem('shoppingList')) || [];\n  const totalItems = cartItems.length;\n\n  const paginationContainer = document.querySelector('.pagination-container');\n\n  if (totalItems > itemsPerPage) {\n    const paginationOptions = {\n      totalItems: totalItems,\n      itemsPerPage: itemsPerPage,\n      visiblePages: 3,\n      centerAlign: true,\n      page: currentPage,\n      template: {\n        page: '<a href=\"#\" class=\"tui-page-btn\">{{page}}</a>',\n        currentPage:\n          '<strong class=\"tui-page-btn tui-is-selected\">{{page}}</strong>',\n        moveButton:\n          '<a href=\"#\" class=\"tui-page-btn tui-page-btn-moveButton\">' +\n          '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n          '</a>',\n        disabledMoveButton:\n          '<span class=\"tui-page-btn tui-page-btn-disabledMoveButton tui-is-disabled\">' +\n          '<span class=\"tui-ico-{{type}}\">{{type}}</span>' +\n          '</span>',\n        moreButton:\n          '<a href=\"#\" class=\"tui-page-btn tui-page-btn-moreButton tui-{{type}}-is-ellip\">' +\n          '<span class=\"tui-ico-ellip\">...</span>' +\n          '</a>',\n      },\n    };\n\n    const existingPagination =\n      paginationContainer.querySelector('.tui-pagination');\n    if (existingPagination) {\n      existingPagination.remove();\n    }\n\n    const pagination = new Pagination(paginationContainer, paginationOptions);\n\n    pagination.on('afterMove', function (event) {\n      currentPage = event.page;\n      updateShoppingList(currentPage);\n    });\n  } else {\n    hidePagination();\n  }\n}\n\nfunction restorePaginationButtonsClasses() {}\n"],"names":["image","listElem","paginationContainer","itemsPerPage","currentPage","initShoppingList","initPagination","updateShoppingList","handleDeleteButtonClick","event","card","cart","index","item","startIdx","endIdx","updatePagination","renderEmptyPage","hidePagination","updateMargin","items","titleElem","renderCartItems","cartItems","totalItems","renderedHTML","templateShopListBooks","emptyMarkup","storedValue","paginationOptions","Pagination","page","pageItems","existingPagination"],"mappings":"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"}